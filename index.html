<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Programme MBA</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        
        :root {
            --bg-color: #1a202c;
            --card-bg: #2d3748;
            --card-bg-light: #4a5568;
            --text-color: #e2e8f0;
            --secondary-text-color: #a0aec0;
            --accent-yellow: #ffc107;
            --accent-pink: #ff4081;
            --accent-green: #38a169;
            --accent-indigo: #4c51bf;
            --accent-fuchsia: #d53f8c;
            --accent-blue: #4299e1;
            --accent-orange: #ed8936;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 2rem;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            color: #fff;
            margin-bottom: 0.5rem;
        }

        .header h1 span {
            color: var(--accent-yellow);
        }

        .header p {
            color: var(--secondary-text-color);
        }

        .specialization-selection {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
            border: none;
            color: #fff;
        }

        .btn-cdo {
            background-color: var(--card-bg);
            color: var(--secondary-text-color);
        }

        .btn-cdo.active {
            background-color: var(--accent-orange);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            color: white;
        }

        .btn-sd {
            background-color: var(--card-bg);
            color: var(--secondary-text-color);
        }

        .btn-sd.active {
            background-color: var(--accent-fuchsia);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            color: white;
        }

        .section {
            background-color: var(--card-bg);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-bottom: 2rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .card-header-main {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .card-header h2, .card-header-main h2 {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 700;
        }

        .card-header h3 {
            margin: 0;
            font-size: 1rem;
            font-weight: 600;
        }

        .progress-bar-container {
            width: 6rem;
            background-color: var(--card-bg-light);
            border-radius: 9999px;
            height: 0.5rem;
            overflow: hidden;
            margin-left: 0.5rem;
        }

        .progress-bar {
            height: 100%;
            border-radius: 9999px;
            transition: width 0.5s ease-in-out;
            background: linear-gradient(90deg, #ffc107, #ff4081);
        }

        .progress-bar-block {
            height: 100%;
            border-radius: 9999px;
            transition: width 0.5s ease-in-out;
        }

        .progress-bar-cdo {
            background-color: var(--accent-orange);
        }

        .progress-bar-sd {
            background-color: var(--accent-fuchsia);
        }

        .block-container {
            border-left: 4px solid var(--card-bg-light);
        }

        .chevron-icon {
            width: 1.5rem;
            height: 1.5rem;
            transition: transform 0.3s;
        }

        .chevron-icon.rotate {
            transform: rotate(90deg);
        }

        .evaluation-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 0;
        }

        .evaluation-item input[type="checkbox"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 1rem;
            height: 1rem;
            background-color: var(--bg-color);
            border: 1px solid var(--card-bg-light);
            border-radius: 0.25rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .evaluation-item input[type="checkbox"]:checked {
            background-color: var(--accent-pink);
            border-color: var(--accent-pink);
        }

        .evaluation-item input[type="checkbox"]:checked::after {
            content: '✓';
            display: block;
            color: white;
            text-align: center;
            line-height: 1rem;
        }

        .evaluation-details {
            font-size: 0.875rem;
            color: var(--secondary-text-color);
        }

        .criteria-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .criteria-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .criteria-bullet {
            font-size: 1rem;
            margin-right: 0.5rem;
            flex-shrink: 0;
            color: var(--accent-yellow);
        }

        .justified-text {
            text-align: justify;
        }

        .form-section {
            background-color: var(--card-bg);
            border-radius: 0.75rem;
            padding: 2rem;
            max-width: 40rem;
            margin: 0 auto 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            margin-top: 0.25rem;
            border-radius: 0.375rem;
            border: 1px solid var(--card-bg-light);
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .btn-primary {
            background-color: var(--accent-blue);
            color: white;
            font-weight: 700;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            transition: background-color 0.2s;
        }
        
        .btn-primary:hover {
            background-color: #3182ce;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .social-link {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            border-radius: 9999px;
            color: white;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.2s;
        }

        .whatsapp {
            background-color: var(--accent-green);
        }
        
        .whatsapp:hover {
            background-color: #2f855a;
        }

        .discord {
            background-color: var(--accent-indigo);
        }
        
        .discord:hover {
            background-color: #434190;
        }

        .notion {
            background-color: var(--accent-pink);
        }
        
        .notion:hover {
            background-color: #d53f8c;
        }

        .scroll-to-top {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background-color: var(--accent-blue);
            color: white;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: background-color 0.2s;
        }
        
        .scroll-to-top:hover {
            background-color: #3182ce;
        }

        .scroll-to-top-icon {
            width: 1.5rem;
            height: 1.5rem;
        }

        .text-cdo {
            color: var(--accent-orange);
        }

        .text-sd {
            color: var(--accent-fuchsia);
        }
        
        .bg-cdo {
            background-color: var(--accent-orange);
        }

        .bg-sd {
            background-color: var(--accent-fuchsia);
        }

        .border-cdo {
            border-color: var(--accent-orange);
        }

        .border-sd {
            border-color: var(--accent-fuchsia);
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1 class="header">
                🚀 Programme <span class="text-accent-yellow">MBA</span>
            </h1>
            <p class="text-secondary-text-color">
                Chief Digital Officer (CDO) et Stratégie Digitale (SD)
            </p>
        </header>

        <div id="app-root"></div>

        <section id="motivational-phrase" class="section text-center"></section>
        
        <footer class="text-center text-secondary-text-color mt-12">
            <h3 class="text-lg font-semibold mb-4 text-white">Rejoignez-nous !</h3>
            <div class="social-links">
                <a href="https://chat.whatsapp.com/LHiRDN32feFCEko7VxH5oz" target="_blank" rel="noopener noreferrer" class="social-link whatsapp">
                    <span>💬 WhatsApp</span>
                </a>
                <a href="https://discord.gg/DmKDG5FruF" target="_blank" rel="noopener noreferrer" class="social-link discord">
                    <span>👾 Discord</span>
                </a>
                <a href="https://www.notion.so/team/208c2c02-df37-8146-b883-004268501963/join" target="_blank" rel="noopener noreferrer" class="social-link notion">
                    <span>✨ Notion</span>
                </a>
            </div>
            <p class="mt-8 text-sm text-gray-500">
                Créatrice de ce document : Mathilde de Martine PAISLEY "L'Enervante Enervante 🤪"
            </p>
        </footer>

        <button id="scroll-to-top-btn" class="scroll-to-top" style="display: none;">
            <svg class="scroll-to-top-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 4l-8 8h6v8h4v-8h6z" />
            </svg>
        </button>
    </div>

    <script>
        // Déclaration des données statiques du programme et des sessions
        const initialProgramData = [
            {
                code: 'B1',
                title: "Animer un processus de problématisation et d’idéation à partir d'une analyse des besoins clients",
                modules: [
                    { code: 'B1_M1', title: 'Analyser les besoins de clients internes/externes', topics: ['La place de la stratégie digitale...', 'L\'environnement technologique...', 'La culture et les valeurs...', 'Les études de marché...', 'La notion de concurrence...', 'Le benchmark digital...', 'Le recueil et l\'analyse des besoins...', 'Identifier et comprendre le client...', 'Le brief digital...'] },
                    { code: 'B1_M2', title: 'Elaborer un dispositif de veille...', topics: ['La démarche de veille...', 'La veille technologique...', 'La veille concurrentielle et sectorielle...', 'Les autres types de veille...', 'Les matrices de veille...', 'L\'évaluation de la fiabilité...'] },
                    { code: 'B1_M3', title: 'Interpréter et articuler une problématique...', topics: ['La problématique d\'innovation...', 'Orienter le projet d\'innovation...'] },
                    { code: 'B1_M4', title: 'Identifier et analyser l’ensemble des risques...', topics: ['Analyse des contraintes...', 'Analyse des risques...', 'Analyse de l\'impact...'] },
                    { code: 'B1_M5', title: 'Animer un processus créatif...', topics: ['Apprendre à générer des idées...', 'Design Thinking : Définir la problématique...', 'Design Thinking : La phase d’idéation...', 'Design Thinking : La phase de prototypage...', 'Design Thinking : La phase de test...', 'Design Thinking : La phase de d\'itération...', 'Animer un atelier de brainstorming...', 'Préparer et présenter un dossier de conception...'] },
                    { code: 'B1_M6', title: 'Evaluer l’adéquation des pistes créatives...', topics: ['La complémentarité études qualitatives / études quantitatives...', 'Les études qualitatives...', 'La mise en œuvre d\'études qualitatives...', 'Les types d\'études quantitatives...', 'La réalisation d\'une enquête...', 'Les méthodes d\'échantillonnage...', 'Les études à l\'épreuve du numérique...'] },
                ],
                evaluation: { title: "Évaluation du Bloc 1", isCompleted: false }
            },
            {
                code: 'B2',
                title: 'Concevoir un projet de transformation et/ou d’innovation',
                modules: [
                    { code: 'B2_M1', title: 'Elaborer la proposition de valeur d’un projet', topics: ['Les fondamentaux d\'une proposition de valeur...', 'Les objectifs d\'une proposition de valeur...', 'Construire et communiquer sa proposition de valeur...'] },
                    { code: 'B2_M2', title: 'Définir l’organisation, les étapes et les besoins en ressources d\'un projet', topics: ['La planification d\'un projet web...', 'Le rôle de la note de cadrage...', 'La rédaction d\'un cahier des charges...', 'Les différents acteurs du projet...', 'Identifier et sélectionner les prestataires...', 'La construction d\'un tableau de bord opérationnel...'] },
                    { code: 'B2_M3', title: 'Définir le modèle économique', topics: ['Le budget digital et les décisions d’investissement...', 'Calculer la rentabilité d’un projet digital...', 'L\'Executive Summary d\'un projet d\'innovation...'] },
                    { code: 'B2_M4', title: 'Définir le business plan d\'un projet de transformation...', topics: ['La préparation et la structuration du business plan...', 'La faisabilité économique et financière...', 'Quels chiffres dans un business plan...'] },
                    { code: 'B2_M5', title: 'Défendre la solution sélectionnée...', topics: ['Présenter son Business Plan...', 'Soutenir son business plan...', 'La présentation écrite d\'un projet...', 'Des présentations de résultats impactantes...'] },
                ],
                evaluation: {
                    title: "Évaluation du Bloc 2",
                    details: [
                        { label: "Évaluation écrite", isCompleted: false },
                        { label: "Évaluation vidéo", isCompleted: false }
                    ]
                }
            },
            {
                code: 'B3',
                title: 'Concevoir et mettre en œuvre une stratégie de communication interne/externe',
                modules: [
                    { code: 'B3_M1', title: 'Identifier les cibles de communication...', topics: ['Identifier ses cibles...', 'Les objectifs de communication...', 'Les cibles en fonction des différents réseaux sociaux...', 'La création des personas...'] },
                    { code: 'B3_M2', title: 'Concevoir et déployer une stratégie de communication à destination de cibles internes', topics: ['La stratégie de communication : le positionnement...', 'La stratégie de communication : Les objectifs...', 'La stratégie de communication : Les cibles...', 'La stratégie de communication : L\'axe créatif...', 'Le projet de communication...', 'Fixer des objectifs SMART...', 'Les outils de mesure de l\'efficacité...', 'La place de la conduite du changement...'] },
                    { code: 'B3_M3', title: 'Elaborer une stratégie de communication à destination de cibles externes', topics: ['Le positionnement de communication...', 'Le rôle du plan de communication...', 'Les composantes du plan de communication...', 'La définition des médias cible...', 'La budgétisation et le calendrier des actions...'] },
                    { code: 'B3_M4', title: 'Réaliser une campagne de communication créative', topics: ['Les messages clés dans le cadre d\'une communication efficace...', 'Structurer son message...', 'Production d\'un message...', 'Le storytelling...', 'Les moyens et supports de communication...'] },
                ],
                evaluation: { title: "Évaluation du Bloc 3", isCompleted: false }
            },
            {
                code: 'B4',
                title: 'Piloter un projet d’innovation et/ou de transformation jusqu\'à la phase de rendu final',
                modules: [
                    { code: 'B4_M1', title: 'Réaliser le prototypage des différentes pistes créatives', topics: ['La phase d’idéation...', 'Le prototypage de la solution...', 'La réalisation de maquettes...', 'Introduction au parcours interactif...'] },
                    { code: 'B4_M2', title: 'Observer les utilisateurs durant la phase test', topics: ['Test utilisateur...', 'Evaluation quantitative...', 'Evaluation qualitative...', 'Recueillir des informations...', 'Élaborer les fiches d\'observation...', 'Construire les rapports de test...'] },
                    { code: 'B4_M3', title: 'Concevoir et réaliser une solution...', topics: ['La démarche qualité...', 'La mesure de la qualité...', 'Les tests qualité...', 'Normes et réglementations...', 'Low tech...', 'Présentation d\'une maquette...'] },
                    { code: 'B4_M4', title: 'Piloter des revues de projet', topics: ['La revue de projet dans le cycle de vie...', 'Les participants à la revue de projet...', 'Animer des réunions structurées...', 'Les outils d\'une revue de projet...'] },
                    { code: 'B4_M5', title: 'Évaluer l\'atteinte des objectifs...', topics: ['Le cahier des charges des livrables...', 'Éléments et critères de mesure de l\'expérience client...', 'Le management de la qualité des projets...', 'L\'évaluation d\'un projet : le bilan qualitatif...'] },
                    { code: 'B4_M6', title: 'Piloter une démarche d’amélioration continue', topics: ['Le suivi des indicateurs qualité...', 'Organiser une gouvernance...', 'Méthodologie pour piloter un projet digital...', 'Émettre des recommandations pour les futurs projets...'] },
                ],
                evaluation: { title: "Évaluation du Bloc 4", isCompleted: false }
            },
            {
                code: 'B5',
                title: 'Manager une équipe projet, une direction technique et/ou une équipe transverse',
                modules: [
                    { code: 'B5_M1', title: 'Sélectionner les membres de l’équipe projet...', topics: ['Recruter les compétences opérationnelles...', 'Les compétences et talents...', 'Typologie des organismes de prestataires...', 'L\'utilité du suivi de la performance...', 'La performance et l\'évaluation de la prestation...'] },
                    { code: 'B5_M2', title: 'Évaluer l’adéquation entre les profils des collaborateurs...', topics: ['Cartographier les compétences...', 'Les compétences comportementales ou soft skills...', 'La maîtrise des processus...', 'Les relations d\'équipes face aux tâches...', 'L\'amélioration du travail en équipe...', 'La communication avec l\'équipe projet...', 'Traiter les dysfonctionnements...'] },
                    { code: 'B5_M3', title: 'Diriger une équipe projet composée d\'intervenants internes et externes', topics: ['Communiquer sur son projet...', 'Le business model canvas...', 'La présentation écrite d\'un projet...', 'La politique d\'inclusion en entreprise...', 'La lutte contre la discrimination...'] },
                ],
                evaluation: { title: "Évaluation du Bloc 5", isCompleted: false }
            },
            {
                code: 'B6',
                title: 'Garantir la performance d’un projet de transformation et/ou d’innovation en matière de technique et/ou technologie',
                specialization: 'CDO',
                modules: [
                    { code: 'B6_M1', title: 'Piloter un projet de transformation...', topics: ['Les spécificités du projet digital...', 'Le recueil de l\'analyse des besoins...', 'Définir la solution et le projet cibles...', 'Définir les objectifs et faire valider...', 'Le choix technologique de la solution...', 'Le cahier des charges technique : détailler...', 'Le cahier des charges technique : du besoin...', 'La construction du planning...', 'Les principaux acteurs : la maîtrise d’œuvre...', 'Les principaux acteurs : la maîtrise d’ouvrage...', 'Établir la gouvernance du projet...'] },
                    { code: 'B6_M2', title: 'Définir l’architecture technique adaptée...', topics: ['Introduction aux architectures multicouches...', 'Les design patterns...', 'Les frameworks et ORM...', 'Les microservices et architecture distribuée...', 'L\'éco-conception dans l\'architecture logicielle...', 'L\'offre de service d\'un fournisseur Cloud...', 'Les solutions SaaS...', 'Les principes de sécurité en architecture...', 'La réalisation de l\'étude de faisabilité...', 'Le cahier des charges technique : description...', 'Le cahier des charges techniques : budget, délais...', 'Rédiger un dossier technique d\'architecture...'] },
                    { code: 'B6_M3', title: 'Tester sa solution digitale', topics: ['La démarche qualité en développement...', 'La démarche DevOps...', 'La mise en place de l\'intégration continue (CI)...', 'La mise en place de la livraison...', 'Les enjeux des plans de test...', 'Élaborer un scénario de test...', 'Mettre en place un environnement de test...', 'Les outils et les stratégies des tests de sécurité...', 'Planifier efficacement les tests...', 'Valider les résultats des tests...', 'Automatiser les tests en DevOps...'] },
                    { code: 'B6_M4', title: 'Émettre des préconisations quant à la résolution de problèmes techniques', topics: ['La résolution d\'une situation critique...', 'Réaliser une analyse causale...', 'La conception de la solution grâce au Design Thinking...'] },
                ],
                evaluation: { title: "Évaluation du Bloc 6", isCompleted: false }
            },
            {
                code: 'B7',
                title: 'Concevoir et mettre en œuvre de la stratégie de communication',
                specialization: 'SD',
                modules: [
                    { code: 'B7_M1', title: 'Élaborer et déployer une stratégie de brand content', topics: ['Une introduction à la stratégie de contenu...', 'Les étapes de la stratégie de contenu...', 'Les KPI dans la stratégie de contenu...', 'Le développement d\'une stratégie de contenu...', 'Les étapes de la stratégie de création...', 'Réussir sa stratégie de création...', 'L\'orientation artistique et le brief créatif...', 'Introduction à la production de contenus...', 'La création de contenu digital...', 'Le brand content...', 'Le brand content et le storytelling...', 'Le contenu de marque...'] },
                    { code: 'B7_M2', title: 'Promouvoir un site internet, une application mobile ou une web app', topics: ['Les sites internet...', 'Le référencement des sites Web...', 'Les nouvelles techniques du SEO...', 'UX/UI Design...', 'Les coûts de promotion...', 'Introduction aux social ads...', 'Les différentes formes de communication...', 'Les moyens et supports...', 'Les supports audio-visuels...', 'Le multicanal et le mix marketing...', 'Les outils de mesure de l\'efficacité...'] },
                    { code: 'B7_M3', title: 'Produire un contenu différenciant', topics: ['La rédaction de la charte...', 'Les outils du content marketing...', 'Animation du plan d’action marketing...', 'Produire du contenu avec l\'IA générative...'] },
                ],
                evaluation: { title: "Évaluation du Bloc 7", isCompleted: false }
            },
        ];

        const sessionsData = [
            { promo: '2025', session: 'Session 2', startDate: '2025-01-01', endDate: '2025-11-24', status: '✅ Date confirmée par Studie', isConfirmed: true },
            { promo: '2026', session: 'Session 1', startDate: '2026-01-01', endDate: '2026-05-28', status: '⚠️ Date fictive – en attente de validation', isConfirmed: false },
            { promo: '2026', session: 'Session 2', startDate: '2026-01-01', endDate: '2026-11-26', status: '⚠️ Date fictive – en attente de validation', isConfirmed: false },
            { promo: '2027', session: 'Session 1', startDate: '2027-01-01', endDate: '2027-05-27', status: '⚠️ Date fictive – en attente de validation', isConfirmed: false },
            { promo: '2027', session: 'Session 2', startDate: '2027-01-01', endDate: '2027-11-25', status: '⚠️ Date fictive – en attente de validation', isConfirmed: false },
            { promo: '2028', session: 'Session 1', startDate: '2028-01-01', endDate: '2028-05-25', status: '⚠️ Date fictive – en attente de validation', isConfirmed: false },
            { promo: '2028', session: 'Session 2', startDate: '2028-01-01', endDate: '2028-11-23', status: '⚠️ Date fictive – en attente de validation', isConfirmed: false },
        ];

        const sharedEvaluationCriteria = {
            B1: {
                title: "Animer un processus de problématisation et d'idéation...",
                criteria: {
                    "C1.1 Analyser les besoins de clients internes/externes": [
                        "Démontre la bonne utilisation de grilles de lecture issues de plusieurs disciplines (sciences humaines et sociales, sciences du design, marketing, management,...).",
                        "Identification des enjeux et des forces sous-jacents à la demande.",
                        "Démontre sa compréhension de la culture d'entreprise et du positionnement du commanditaire, et leur influence sur les enjeux rencontrés.",
                        "Démontre la maîtrise des méthodologies d'interviews, de questionnements et de reformulation."
                    ],
                    "C1.2 Élaborer un dispositif de veille": [
                        "Présentation d'une cartographie des principaux domaines de veille exposant la finalité générale, les objectifs précis et les moyens mobilisés.",
                        "Démontre la pertinence des outils de veille utilisés au regard des objectifs recherchés.",
                        "Démontre la pertinence et la fiabilité des sources utilisées.",
                        "Synthétise l'information et démontre sa capacité à la restituer.",
                        "Démontre l'intérêt des informations complémentaires recherchées."
                    ],
                    "C1.3 Interpréter et articuler une problématique": [
                        "Au travers de sa formulation, le cadre d'intervention et les enjeux doivent transparaître de manière claire et concise de façon à ce que le lecteur puisse déjà avoir une idée sur les portées et limites de l'étude.",
                        "La possibilité de travailler sur le sujet prédéfini se démontre dans l'énonciation de la problématique.",
                        "Le respect de l'équilibre entre l'exploration et la quête d'innovation est impératif.",
                        "Démontre l'intérêt de la problématique au regard de la culture d'entreprise, des besoins préalablement identifiés, de son positionnement, et des enjeux rencontrés."
                    ],
                    "C1.4 Identifier et analyser l'ensemble des risques": [
                        "Démontre sa connaissance des concepts et méthodes de management des risques.",
                        "Définit une politique de management des risques réaliste au regard du contexte.",
                        "Les événements susceptibles de représenter un risque pour le projet sont identifiés de façon exhaustive.",
                        "Démontre sa maîtrise des outils de gestion des risques (modèle de cotation de la gravité).",
                        "Les préconisations en matière de gestion des risques sont cohérentes et pertinentes."
                    ],
                    "C1.5 Animer un processus créatif": [
                        "Le candidat présente de façon ludique l'atelier et explicite les règles et la méthodologie de déploiement. L'explication est claire et compréhensible pour un public néophyte.",
                        "La méthodologie et les outils utilisés permettent de favoriser la génération d'idées et de garantir le maintien d'une bonne atmosphère.",
                        "Le candidat démontre l'apport de la méthodologie par rapport au projet à mener. Il explicite et argumente son choix. Il démontre une prise de hauteur nécessaire."
                    ],
                    "C1.6 Évaluer l'adéquation des pistes créatives": [
                        "Le candidat utilise des méthodologies de tests utilisateurs (quantitatifs ou qualitatifs) suivant des protocoles ad hoc adaptés.",
                        "Le candidat adopte une attitude d'apprentissage et ne cherche pas à défendre sa solution ou à influencer les réponses.",
                        "Démontre sa capacité à prendre en compte des éléments issus de la communication non verbale.",
                        "Le candidat documente les résultats de manière à en faciliter l'analyse."
                    ]
                }
            },
            B2: {
                title: "Concevoir un projet de transformation et/ou d'innovation",
                criteria: {
                    "C2.1 Élaborer la proposition de valeur": [
                        "La proposition de valeur est pertinente car elle répond à la problématique définie.",
                        "Le candidat présente les avantages de l'offre face à la concurrence de façon synthétique et réaliste.",
                        "Il démontre que la proposition de valeur est unique et claire."
                    ],
                    "C2.2 Définir l'organisation": [
                        "Le candidat choisit et détaille une méthodologie de projet adaptée à l'organisation.",
                        "Démontre sa maîtrise de la méthodologie de gestion de projet.",
                        "Il identifie correctement les parties intéressées et présente une gouvernance du projet efficiente.",
                        "Il propose un compte rendu et un document de suivi pertinents (visuel, reprenant les solutions sélectionnées, le rétroplanning et les livrables attendus)."
                    ],
                    "C2.3 et C2.4 Définir le modèle économique et le business plan": [
                        "L'executive summary est synthétique, percutant, pédagogique et didactique.",
                        "Démontre sa maîtrise de la structure d'un business plan complet (nom de l'entreprise, activité, valeurs, histoire, audience cible, typologie du marché).",
                        "Les moyens nécessaires à la mise en œuvre du projet sont listés et sont réalistes.",
                        "L'évaluation des investissements et des charges globales est cohérente au regard des capacités de financements."
                    ],
                    "C2.5 Défendre la solution sélectionnée": [
                        "Le candidat propose des préconisations pertinentes et démontre l'exploitation et la bonne interprétation des résultats des tests utilisateurs.",
                        "Le candidat respecte le cadre et le formalisme imposés.",
                        "La présentation est argumentée et convaincante."
                    ]
                }
            },
            B3: {
                title: "Conception et mise en œuvre d'une stratégie de communication interne/externe",
                criteria: {
                    "C3.1 Identifier les cibles de communication": [
                        "Le candidat propose une identification de la cible complète (habitudes, persona, âge, besoins).",
                        "Il segmente la clientèle de manière pertinente.",
                        "La construction d'un personae synthétise de façon claire et concise les résultats de l'analyse de l'audience.",
                        "Les objectifs de la stratégie de communication sont définis et sont SMART."
                    ],
                    "C3.2 Concevoir et déployer une stratégie de communication interne": [
                        "Les actions de communication déployées permettent aux collaborateurs de s'approprier le projet.",
                        "Les indicateurs de résultats de la stratégie sont définis."
                    ],
                    "C3.3 Élaborer une stratégie de communication externe": [
                        "La stratégie de communication reflète une traduction créative de la proposition de valeur du projet.",
                        "Les objectifs de la stratégie sont définis et sont SMART.",
                        "Les axes de communication et les différents canaux sont définis et adaptés à la cible.",
                        "Le plan de communication est élaboré, avec des actions temporellement planifiées.",
                        "Le budget de la stratégie est défini et respecté."
                    ],
                    "C3.4 Réaliser une campagne de communication créative": [
                        "Les objectifs du dispositif de communication sont clairement définis.",
                        "Le message du dispositif est bref et percutant.",
                        "Les techniques de storytelling sont utilisées.",
                        "Les choix effectués respectent les codes de la marque et sont adaptés à son canal de diffusion (online, off-line) et au support."
                    ]
                }
            },
            B4: {
                title: "Piloter un projet d'innovation et/ou de transformation...",
                criteria: {
                    "C4.1 Réaliser le prototypage": [
                        "Prise en compte des informations qualitatives et quantitatives lors des recherches exploratoires pour la création des représentations de produits, de services, d'espace et d'identité.",
                        "Qualité et pertinence des représentations produites.",
                        "Pertinence des différents choix techniques, matériaux, données, ergonomie.",
                        "Créativité et choix esthétiques.",
                        "Pertinence des solutions proposées au regard du brief et de la démarche mise en œuvre."
                    ],
                    "C4.2 Observer les utilisateurs": [
                        "Le candidat utilise des méthodologies de tests utilisateurs quantitatifs ou qualitatifs.",
                        "Le candidat adopte une attitude d'apprentissage et ne cherche pas à défendre sa solution ou à influencer les réponses.",
                        "Démontre sa capacité à prendre en compte des éléments issus de la communication non verbale.",
                        "Le candidat documente les résultats de manière à en faciliter l'analyse."
                    ],
                    "C4.3 Concevoir et réaliser une solution": [
                        "Démontre la prise en compte de plusieurs critères lors de l'évaluation d'une maquette de principe (fonctionnalités, ergonomie, réactions des utilisateurs).",
                        "Pertinence de l'application de la solution (utilité, utilisabilité et plaisir à l'usage)."
                    ],
                    "C4.4 Piloter des revues de projet": [
                        "Le candidat démontre que la revue de projet a été menée de façon complète et systématique à l'aide de documents.",
                        "Il démontre que la revue de projet a permis d'évaluer le respect des exigences qualité, d'identifier les problèmes et de proposer des solutions.",
                        "Les documents utilisés retracent l'évolution du projet, rappellent les objectifs et prennent en compte les aspects légaux et réglementaires."
                    ],
                    "C4.5 Évaluer l'atteinte des objectifs": [
                        "Les indicateurs de suivi et de réussite du projet utilisés sont pertinents.",
                        "Le candidat démontre que le projet a été piloté avec le souci de respecter la problématique.",
                        "Il propose une évaluation globale du déroulé et de la réussite du projet."
                    ],
                    "C4.6 Piloter une démarche d'amélioration continue": [
                        "Le candidat explicite la façon dont il va mobiliser la direction générale et la gouvernance du projet.",
                        "La démarche itérative est explicitée et permet d'intégrer facilement des ajustements éventuels.",
                        "Le candidat identifie correctement les objectifs et freins potentiels à la réalisation du projet, et apporte des réponses permettant de lever ces résistances aux changements."
                    ]
                }
            },
            B5: {
                title: "Management d'une équipe projet, d'une direction technique et/ou d'une équipe transverse",
                criteria: {
                    "C5.1 et C5.2 Sélectionner et évaluer l'équipe": [
                        "Le candidat traduit correctement les enjeux du projet et les compétences clés à maîtriser.",
                        "Il identifie des critères ayant permis de constituer une équipe (expérience, diplômes, aspirations).",
                        "Il évalue la performance de chaque membre et explicite les axes d'amélioration.",
                        "Le candidat évalue justement le besoin en compétence de l'équipe projet.",
                        "Explication claire du rôle de chacun et des ajustements mis en œuvre."
                    ],
                    "C5.3 Diriger une équipe projet": [
                        "Le document doit expliquer de façon claire et pédagogique aux différentes parties prenantes le mode de fonctionnement et les conséquences de l'approche de gestion choisie.",
                        "Le candidat rend évidentes les étapes de production de la solution et les ressources mobilisées.",
                        "Il décrit précisément le déroulement et la planification d'un cycle d'itération.",
                        "Il explicite les rôles des membres de l'équipe dans la mise en œuvre de l'approche."
                    ]
                }
            }
        };

        const cdoEvaluationCriteria = {
            B6: {
                title: "Garantir la performance d'un projet de transformation et/ou d'innovation en matière de technique et/ou technologie",
                criteria: {
                    "C6B.1 Piloter un projet de transformation et/ou d'innovation...": [
                        "Il/elle démontre sa capacité à choisir une méthode et des outils de suivi de projet adapté à sa nature et aux objectifs stratégiques préalablement définis.",
                        "Il/elle définit de façon exhaustive les livrables attendus (livrables fonctionnels, éditoriaux, graphiques, et d'intégration...)",
                        "Il présente un calendrier de déploiement de projet réaliste au vu du projet.",
                        "Le candidat présente un plan de coordination des acteurs complet comprenant l'animation de réunion, les temps forts type campagnes de communication/sensibilisation... Le plan de coordination est réaliste."
                    ],
                    "C6B.2 Définir l'architecture technique adaptée...": [
                        "Les nomenclatures utilisées doivent être impérativement univoques et homogènes.",
                        "Le document de spécifications fonctionnelles doit être structuré, hiérarchisé, lisible et s'appuyer sur des représentations graphiques dans le respect des bonnes pratiques et des standards du secteur.",
                        "Les enjeux d'évolutivité de la solution doivent être la clé des choix architecturaux et de l'expression de leur motivation dans le document."
                    ],
                    "C6B.3 Emettre des préconisations quant à la résolution de problèmes techniques...": [
                        "Le candidat devra expliciter et valider au regard des connaissances et bonnes pratiques existantes: la méthode adéquate pour identifier la source des bogues, la manière de les pratiques de test et la validation des correctifs.",
                        "Les préconisations en matière de corrections de bogues sont réalistes et pertinentes au regard du problème technique identifié.",
                        "Le candidat utilise correctement le vocabulaire et les terminologies métiers."
                    ]
                }
            }
        };

        const sdEvaluationCriteria = {
            B7: {
                title: "Concevoir et mettre en œuvre de la stratégie de communication",
                criteria: {
                    "C6A.1 Élaborer et déployer une stratégie de brand content": [
                        "Le candidat identifie correctement son audience (groupe de personnes susceptibles d'adhérer à la marque et/ou de réagir à son discours).",
                        "La stratégie de brand content est claire et intègre l'identité visuelle, la planification des publications, les types de contenus (écrits, visuels, sonores, audiovisuels, oeuvres... à publier et la teneur des messages à porter (style, vocabulaire, ton...)).",
                        "Le candidat choisit les médias pertinents sur lesquels diffuser sa stratégie de brand content au regard de la stratégie globale de l'organisation et de sa cible."
                    ],
                    "C6A 2 Promouvoir un site internet, une application mobile ou une web app": [
                        "Le candidat propose une stratégie de référencement (naturel et payant) cohérente par rapport à la stratégie globale de l'organisation, sa cible, son positionnement et son budget.",
                        "Le candidat présente une stratégie de cross-promotion réaliste et pertinente intégrant l'ensemble des médias sur lesquels communiquer en vue de la promotion du site interne/de l'application mobile/web mobile."
                    ],
                    "C6A.3 Produire un contenu différenciant et/ou innovant": [
                        "Le candidat détermine des objectifs chiffrés et mesurables d'acquisition et de transformation des cibles visées selon les canaux de communication retenus dans le cadre de la stratégie de brand content.",
                        "Le candidat propose une ligne éditoriale claire et différenciante. Cette ligne éditoriale est respectée dans le cadre de la production des différents contenus.",
                        "Le contenu proposé par le candidat est différenciant en ce sens qu'il aborde le sujet en profondeur, en s'appuyant sur l'existant (source) et en intégrant un point de vue novateur.",
                        "Le candidat démontre sa capacité à mobiliser des connaissances théoriques (théories, actualité, méthodes de travail...) et à les adapter pour répondre à un contexte spécifique et complexe."
                    ]
                }
            }
        };

        const motivationalPhrases = [
            { title: "N'abandonnez jamais", text: "Chaque pas, même le plus petit, vous rapproche de votre objectif. La persévérance est la clé du succès." },
            { title: "Le succès est au bout de l'effort", text: "La seule limite à notre épanouissement de demain sera nos doutes d'aujourd'hui." },
            { title: "Croyez en vos rêves", text: "La meilleure façon de prédire l'avenir est de le créer." },
            { title: "Chaque jour est une nouvelle chance", text: "Ne laissez pas hier prendre trop de place aujourd'hui." },
            { title: "Le travail d'équipe rend le rêve possible", text: "Seul on va plus vite, ensemble on va plus loin." },
        ];

        // État de l'application
        let selectedSpecialization = localStorage.getItem('mba_tracker_specialization') || 'CDO';
        let programProgress = JSON.parse(localStorage.getItem('mba_tracker_progress')) || initialProgramData.map(block => ({
            ...block,
            modules: block.modules.map(module => ({ ...module, topics: module.topics.map(topic => ({ text: topic, isCompleted: false })) })),
            evaluation: block.evaluation ? { ...block.evaluation, isCompleted: false, details: block.evaluation.details ? block.evaluation.details.map(d => ({...d, isCompleted: false})) : undefined } : undefined,
        }));
        let sessions = sessionsData;
        let expandedBlocks = JSON.parse(localStorage.getItem('mba_tracker_expandedBlocks')) || {};
        let expandedModules = JSON.parse(localStorage.getItem('mba_tracker_expandedModules')) || {};
        let isCalendarTableExpanded = JSON.parse(localStorage.getItem('mba_tracker_calendarExpanded')) || false;
        let selectedSessionIndex = localStorage.getItem('mba_tracker_selectedSessionIndex') || 0;
        let countdown = {};
        let motivationalPhrase = {};
        let userInfo = JSON.parse(localStorage.getItem('mba_tracker_user_info'));
        let isFormVisible = !userInfo;

        // Éléments du DOM
        const appRoot = document.getElementById('app-root');
        const scrollBtn = document.getElementById('scroll-to-top-btn');

        // Fonctions utilitaires
        function saveState() {
            localStorage.setItem('mba_tracker_progress', JSON.stringify(programProgress));
            localStorage.setItem('mba_tracker_specialization', selectedSpecialization);
            localStorage.setItem('mba_tracker_expandedBlocks', JSON.stringify(expandedBlocks));
            localStorage.setItem('mba_tracker_expandedModules', JSON.stringify(expandedModules));
            localStorage.setItem('mba_tracker_calendarExpanded', JSON.stringify(isCalendarTableExpanded));
            localStorage.setItem('mba_tracker_selectedSessionIndex', selectedSessionIndex);
        }

        function calculateProgress(items) {
            const total = items.length;
            if (total === 0) return 0;
            const completed = items.filter(item => item.isCompleted).length;
            return Math.round((completed / total) * 100);
        }

        function formatDate(dateString) {
            const [year, month, day] = dateString.split('-');
            return `${day}/${month}/${year}`;
        }
        
        function getBlockColor(blockCode) {
            if (blockCode === 'B6' && selectedSpecialization === 'CDO') return 'orange';
            if (blockCode === 'B7' && selectedSpecialization === 'SD') return 'fuchsia';
            return 'blue';
        }

        function render() {
            if (isFormVisible) {
                renderForm();
            } else {
                renderMainApp();
            }
        }
        
        function renderForm() {
            appRoot.innerHTML = `
                <div class="form-section">
                    <h2 class="text-2xl font-semibold text-white mb-4">Bienvenue ! 👋</h2>
                    <p class="text-secondary-text-color mb-4">
                        Pour commencer, veuillez saisir vos informations. Elles seront conservées localement dans votre navigateur pour personnaliser votre suivi.
                    </p>
                    <form id="user-form">
                        <div class="mb-4">
                            <label class="block text-secondary-text-color text-sm font-bold mb-2" for="firstName">Prénom</label>
                            <input class="form-input" id="firstName" type="text" value="${userInfo?.firstName || ''}" required>
                        </div>
                        <div class="mb-4">
                            <label class="block text-secondary-text-color text-sm font-bold mb-2" for="name">Nom</label>
                            <input class="form-input" id="name" type="text" value="${userInfo?.name || ''}" required>
                        </div>
                        <div class="mb-6">
                            <label class="block text-secondary-text-color text-sm font-bold mb-2" for="pseudo">Pseudo (facultatif)</label>
                            <input class="form-input" id="pseudo" type="text" value="${userInfo?.pseudo || ''}">
                        </div>
                        <div class="flex items-center justify-between">
                            <button class="btn-primary" type="submit">Commencer</button>
                        </div>
                    </form>
                </div>
            `;
            document.getElementById('user-form').addEventListener('submit', handleFormSubmit);
        }

        function renderMainApp() {
            const userInfoElement = `
                <div class="section max-w-4xl mx-auto">
                    <h2 class="text-2xl font-semibold text-white mb-2">
                        Bienvenue dans votre parcours, <span class="text-accent-yellow">${userInfo.firstName} ${userInfo.name}</span> ! 👋
                    </h2>
                    <p class="text-secondary-text-color mb-4">
                        Ici, vous pouvez suivre votre progression et accéder aux critères d'évaluation de votre programme.
                    </p>
                    <div class="specialization-selection">
                        <button class="btn btn-cdo ${selectedSpecialization === 'CDO' ? 'active' : ''}" onclick="handleSpecializationChange('CDO')">CDO</button>
                        <button class="btn btn-sd ${selectedSpecialization === 'SD' ? 'active' : ''}" onclick="handleSpecializationChange('SD')">SD</button>
                    </div>
                </div>
            `;

            appRoot.innerHTML = userInfoElement + renderCalendar() + renderGlobalProgress() + renderProgramBlocks() + renderEvaluations();
            
            // Re-attacher les écouteurs d'événements pour le calendrier
            document.getElementById('session-select').addEventListener('change', (e) => handleSessionChange(e.target.value));
            document.querySelectorAll('[onchange*="handleDateChange"]').forEach(input => {
                const index = parseInt(input.getAttribute('onchange').match(/\d+/)[0]);
                input.addEventListener('change', (e) => handleDateChange(index, e.target.value));
            });
            document.querySelectorAll('[onclick*="toggleCalendarTable"]').forEach(el => el.addEventListener('click', toggleCalendarTable));
            document.querySelectorAll('[onclick*="toggleBlock"]').forEach(el => {
                const blockCode = el.getAttribute('onclick').match(/'(.*?)'/)[1];
                el.addEventListener('click', () => toggleBlock(blockCode));
            });
            document.querySelectorAll('[onclick*="toggleModule"]').forEach(el => {
                const moduleCode = el.getAttribute('onclick').match(/'(.*?)'/)[1];
                el.addEventListener('click', () => toggleModule(moduleCode));
            });
            document.querySelectorAll('[onchange*="handleTopicChange"]').forEach(input => {
                const args = input.getAttribute('onchange').match(/(\d+|'[^']*')/g);
                const blockIndex = parseInt(args[0]);
                const moduleIndex = parseInt(args[1]);
                const topicIndex = parseInt(args[2]);
                input.addEventListener('change', () => handleTopicChange(blockIndex, moduleIndex, topicIndex));
            });
            document.querySelectorAll('[onchange*="handleEvaluationChange"]').forEach(input => {
                const args = input.getAttribute('onchange').match(/(\d+|'[^']*')/g);
                const blockIndex = parseInt(args[0]);
                const evaluationLabel = args.length > 1 ? args[1].replace(/'/g, '') : null;
                input.addEventListener('change', () => handleEvaluationChange(blockIndex, evaluationLabel));
            });
        }
        
        function renderCalendar() {
            const currentSession = sessions[selectedSessionIndex];
            const countdownHTML = `
                <div class="p-4 bg-gray-900 rounded-lg shadow-inner mb-4">
                    <h3 class="text-lg font-bold mb-2 text-accent-yellow">Compte à rebours de la session sélectionnée</h3>
                    <div class="flex items-center space-x-4 mb-4">
                        <span class="text-secondary-text-color font-medium">Sélectionner une session :</span>
                        <select id="session-select" class="bg-gray-700 text-white border border-gray-600 rounded-md px-3 py-1 focus:outline-none focus:border-blue-500">
                            ${sessions.map((session, index) => `<option value="${index}" ${index == selectedSessionIndex ? 'selected' : ''}>${session.promo} - ${session.session}</option>`).join('')}
                        </select>
                    </div>
                    <div class="grid grid-cols-4 gap-4 text-center">
                        <div class="p-4 bg-gray-700 rounded-lg">
                            <span class="block text-2xl font-bold text-accent-pink">${countdown.days}</span>
                            <span class="block text-sm text-secondary-text-color">Jours</span>
                        </div>
                        <div class="p-4 bg-gray-700 rounded-lg">
                            <span class="block text-2xl font-bold text-accent-pink">${countdown.hours}</span>
                            <span class="block text-sm text-secondary-text-color">Heures</span>
                        </div>
                        <div class="p-4 bg-gray-700 rounded-lg">
                            <span class="block text-2xl font-bold text-accent-pink">${countdown.minutes}</span>
                            <span class="block text-sm text-secondary-text-color">Minutes</span>
                        </div>
                        <div class="p-4 bg-gray-700 rounded-lg">
                            <span class="block text-2xl font-bold text-accent-pink">${countdown.seconds}</span>
                            <span class="block text-sm text-secondary-text-color">Secondes</span>
                        </div>
                    </div>
                    <p class="mt-4 text-sm text-secondary-text-color text-center">
                        Date limite de remise : le ${formatDate(currentSession.endDate)} à 23h59
                    </p>
                </div>
            `;
            
            const tableHTML = `
                <div class="overflow-x-auto mt-4" id="calendar-table" style="display: ${isCalendarTableExpanded ? 'block' : 'none'};">
                    <table class="min-w-full divide-y divide-gray-700">
                        <thead class="bg-gray-700">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Promo</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Session</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Date de début (modifiable)</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Date de fin</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Nature de la date de fin</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-700">
                            ${sessions.map((session, index) => `
                                <tr class="bg-gray-800 hover:bg-gray-700 transition-colors duration-200">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-white">${session.promo}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-secondary-text-color">${session.session}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-secondary-text-color">
                                        <input type="date" value="${session.startDate}" onchange="handleDateChange(${index}, this.value)" class="bg-gray-900 border border-gray-600 rounded-md px-2 py-1 text-sm text-white focus:outline-none focus:border-blue-500" />
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-secondary-text-color">${formatDate(session.endDate)}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                                        <div class="flex items-center space-x-2">
                                            ${session.isConfirmed ? '<svg class="text-accent-green w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" /></svg>' : '<svg class="text-accent-yellow w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L1 21h22L12 2zm1 14h-2v-2h2v2zm0-4h-2V8h2v4z" /></svg>'}
                                            <span class="text-secondary-text-color">${session.status}</span>
                                        </div>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;

            return `
                <section class="section">
                    <div class="card-header-main" onclick="toggleCalendarTable()">
                        <div class="flex items-center">
                            <svg class="chevron-icon ${isCalendarTableExpanded ? 'rotate' : ''}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" /></svg>
                            <h2>Calendrier des sessions 📅</h2>
                        </div>
                    </div>
                    ${countdownHTML}
                    <div class="card-header-main" onclick="toggleCalendarTable()">
                             <div class="flex items-center">
                                <svg class="chevron-icon ${isCalendarTableExpanded ? 'rotate' : ''}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" /></svg>
                                <h3 class="text-white">Détails des sessions</h3>
                             </div>
                    </div>
                    ${tableHTML}
                </section>
            `;
        }

        function renderGlobalProgress() {
            const allTopics = programProgress.flatMap(block =>
                block.modules.flatMap(module => module.topics)
            );
            const progress = calculateProgress(allTopics);
            return `
                <section class="section">
                    <h2 class="text-2xl font-semibold text-white mb-2">Progression Globale 📈</h2>
                    <div class="flex items-center space-x-4">
                        <span class="text-3xl font-extrabold text-white">${progress}%</span>
                        <div class="w-full bg-gray-700 rounded-full h-2.5 mt-2 overflow-hidden">
                            <div class="h-2.5 rounded-full transition-all duration-500 ease-in-out" style="width: ${progress}%; background: linear-gradient(90deg, #ffc107, #ff4081);"></div>
                        </div>
                    </div>
                </section>
            `;
        }

        function renderProgramBlocks() {
            const criteriaTitleColor = selectedSpecialization === 'SD' ? 'text-sd' : 'text-cdo';
            const criteriaBulletColor = selectedSpecialization === 'SD' ? 'text-accent-pink' : 'text-accent-yellow';

            return `
                <main class="grid gap-8">
                    ${programProgress.map((block, blockIndex) => {
                        if (block.specialization && block.specialization !== selectedSpecialization) {
                            return '';
                        }
                        
                        const isBlockExpanded = expandedBlocks[block.code];
                        const blockProgress = calculateProgress(block.modules.flatMap(m => m.topics));
                        const accentColor = getBlockColor(block.code);
                        const headerColor = block.specialization === 'CDO' ? 'text-cdo' : 'text-sd';

                        let criteriaHTML = '';
                        const shared = sharedEvaluationCriteria[block.code];
                        const specific = selectedSpecialization === 'CDO' ? cdoEvaluationCriteria[block.code] : sdEvaluationCriteria[block.code];

                        if (shared || specific) {
                            let criteriaContent = '';
                            if (shared && shared.criteria) {
                                for (const compCode in shared.criteria) {
                                    criteriaContent += `<div class="mb-4">
                                        <h5 class="text-md font-semibold text-gray-300 mb-2">${compCode}</h5>
                                        <ul class="criteria-list space-y-1 text-secondary-text-color">
                                            ${shared.criteria[compCode].map(crit => `
                                                <li class="criteria-item">
                                                    <span class="criteria-bullet">⭐</span>
                                                    <p class="justified-text text-sm text-gray-400">${crit}</p>
                                                </li>
                                            `).join('')}
                                        </ul>
                                    </div>`;
                                }
                            }
                            if (specific && specific.criteria) {
                                criteriaContent += `<h5 class="text-md font-semibold ${headerColor} mb-2 mt-4">
                                    Critères spécifiques au ${selectedSpecialization} :
                                </h5>`;
                                for (const compCode in specific.criteria) {
                                    criteriaContent += `<div class="mb-4">
                                        <h5 class="text-md font-semibold text-gray-300 mb-2">${compCode}</h5>
                                        <ul class="criteria-list space-y-1 text-secondary-text-color">
                                            ${specific.criteria[compCode].map(crit => `
                                                <li class="criteria-item">
                                                    <span class="criteria-bullet">⭐</span>
                                                    <p class="justified-text text-sm text-gray-400">${crit}</p>
                                                </li>
                                            `).join('')}
                                        </ul>
                                    </div>`;
                                }
                            }

                            criteriaHTML = `
                                <div class="mt-4 p-4 bg-gray-900 rounded-xl shadow-inner">
                                    <h4 class="text-lg font-bold ${criteriaTitleColor} mb-4">Critères d'évaluation du bloc 📝</h4>
                                    ${criteriaContent}
                                </div>
                            `;
                        }
                        
                        return `
                            <div class="section block-container">
                                <div class="card-header" onclick="toggleBlock('${block.code}')">
                                    <div class="flex items-center">
                                        <svg class="chevron-icon ${isBlockExpanded ? 'rotate' : ''}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" /></svg>
                                        <h2 class="${headerColor}">${block.code} : ${block.title}</h2>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="text-lg font-semibold text-white">${blockProgress}%</span>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar-block bg-${accentColor}" style="width: ${blockProgress}%;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div id="block-content-${block.code}" style="display: ${isBlockExpanded ? 'block' : 'none'};">
                                    ${block.modules.map((module, moduleIndex) => `
                                        <div class="p-4 bg-gray-700 rounded-lg mt-4">
                                            <div class="card-header" onclick="toggleModule('${module.code}')">
                                                <div class="flex items-center">
                                                    <svg class="chevron-icon w-5 h-5 mr-2 text-gray-300 ${expandedModules[module.code] ? 'rotate' : ''}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" /></svg>
                                                    <h3 class="text-md font-semibold text-gray-200">${module.code} : ${module.title}</h3>
                                                </div>
                                                <span class="text-sm font-medium text-gray-300">${calculateProgress(module.topics)}%</span>
                                            </div>
                                            <div id="module-content-${module.code}" style="display: ${expandedModules[module.code] ? 'block' : 'none'};">
                                                <div class="grid gap-2 mt-2">
                                                    ${module.topics.map((topic, topicIndex) => `
                                                        <div class="evaluation-item text-gray-300">
                                                            <input type="checkbox" onchange="handleTopicChange(${blockIndex}, ${moduleIndex}, ${topicIndex})" ${topic.isCompleted ? 'checked' : ''} class="form-checkbox" />
                                                            <span class="ml-3 text-sm">${topic.text}</span>
                                                        </div>
                                                    `).join('')}
                                                </div>
                                            </div>
                                        </div>
                                    `).join('')}
                                    ${criteriaHTML}
                                </div>
                            </div>
                        `;
                    }).join('')}
                </main>
            `;
        }

        function renderEvaluations() {
            const filteredBlocks = programProgress.filter(block =>
                !block.specialization || block.specialization === selectedSpecialization
            );
            return `
                <section class="section">
                    <h2 class="text-2xl font-semibold text-white mb-4">Suivi des évaluations 📋</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        ${filteredBlocks.map((block, blockIndex) => {
                            if (block.evaluation) {
                                return `
                                    <div class="p-4 bg-gray-700 rounded-lg">
                                        <h3 class="text-md font-bold text-gray-200 mb-2">${block.evaluation.title}</h3>
                                        ${block.evaluation.details ? block.evaluation.details.map((detail, detailIndex) => `
                                            <div class="evaluation-item text-gray-300">
                                                <input type="checkbox" onchange="handleEvaluationChange(${blockIndex}, '${detail.label}')" ${detail.isCompleted ? 'checked' : ''} class="form-checkbox" />
                                                <span class="ml-3 text-sm">${detail.label}</span>
                                            </div>
                                        `).join('') : `
                                            <div class="evaluation-item text-gray-300">
                                                <input type="checkbox" onchange="handleEvaluationChange(${blockIndex})" ${block.evaluation.isCompleted ? 'checked' : ''} class="form-checkbox" />
                                                <span class="ml-3 text-sm">Évaluation du bloc terminée</span>
                                            </div>
                                        `}
                                    </div>
                                `;
                            }
                            return '';
                        }).join('')}
                    </div>
                </section>
            `;
        }
        
        function renderMotivationalPhrase() {
            const randomPhrase = motivationalPhrases[Math.floor(Math.random() * motivationalPhrases.length)];
            const phraseElement = document.getElementById('motivational-phrase');
            if (phraseElement) {
                 phraseElement.innerHTML = `
                    <div class="p-6 bg-gray-800 rounded-xl shadow-lg">
                        <h3 class="text-xl font-bold mb-2 text-accent-yellow">${randomPhrase.title}</h3>
                        <p class="text-gray-300 text-lg">${randomPhrase.text}</p>
                    </div>
                 `;
            }
        }

        // Gestionnaires d'événements
        function handleFormSubmit(e) {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const firstName = document.getElementById('firstName').value;
            const pseudo = document.getElementById('pseudo').value;
            userInfo = { name, firstName, pseudo };
            localStorage.setItem('mba_tracker_user_info', JSON.stringify(userInfo));
            isFormVisible = false;
            render();
        }

        function handleSpecializationChange(spec) {
            selectedSpecialization = spec;
            saveState();
            render();
        }

        function handleSessionChange(index) {
            selectedSessionIndex = parseInt(index);
            saveState();
            render();
        }
        
        function handleTopicChange(blockIndex, moduleIndex, topicIndex) {
            programProgress[blockIndex].modules[moduleIndex].topics[topicIndex].isCompleted = !programProgress[blockIndex].modules[moduleIndex].topics[topicIndex].isCompleted;
            saveState();
            render();
        }

        function handleEvaluationChange(blockIndex, evaluationLabel = null) {
            const evaluation = programProgress[blockIndex].evaluation;
            if (evaluationLabel && evaluation.details) {
                const detail = evaluation.details.find(d => d.label === evaluationLabel);
                if (detail) {
                    detail.isCompleted = !detail.isCompleted;
                }
            } else {
                evaluation.isCompleted = !evaluation.isCompleted;
            }
            saveState();
            render();
        }

        function toggleBlock(blockCode) {
            expandedBlocks[blockCode] = !expandedBlocks[blockCode];
            saveState();
            render();
        }

        function toggleModule(moduleCode) {
            expandedModules[moduleCode] = !expandedModules[moduleCode];
            saveState();
            render();
        }
        
        function toggleCalendarTable() {
            isCalendarTableExpanded = !isCalendarTableExpanded;
            saveState();
            render();
        }

        function handleDateChange(index, newDate) {
            sessions[index].startDate = newDate;
            saveState();
            render();
        }
        
        // Timer du décompte
        let countdownInterval;
        function updateCountdown() {
            const currentSession = sessions[selectedSessionIndex];
            if (!currentSession) return;
            const deadline = new Date(`${currentSession.endDate}T23:59:59`).getTime();
            const now = new Date().getTime();
            const distance = deadline - now;
            
            if (distance < 0) {
                countdown = { days: 0, hours: 0, minutes: 0, seconds: 0 };
                clearInterval(countdownInterval);
            } else {
                countdown = {
                    days: Math.floor(distance / (1000 * 60 * 60 * 24)),
                    hours: Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)),
                    minutes: Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)),
                    seconds: Math.floor((distance % (1000 * 60)) / 1000),
                };
            }
            render();
        }
        
        // Bouton de retour en haut
        window.onscroll = () => {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                scrollBtn.style.display = "block";
            } else {
                scrollBtn.style.display = "none";
            }
        };

        scrollBtn.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });

        // Initialisation
        document.addEventListener('DOMContentLoaded', () => {
            render();
            renderMotivationalPhrase();
            countdownInterval = setInterval(updateCountdown, 1000);
        });
    </script>
</body>
</html>
